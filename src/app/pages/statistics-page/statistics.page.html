<ion-header>
  <ion-toolbar>
    <ion-title>{{ 'statistics.title' | translate }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" *ngIf="spendingByCategoriesList$ | async as categories" scroll-y="false">

  <div class="period-select">
    <div class="week {{ selectedPeriod === 'week' ? 'checked' : '' }}" (click)="onPeriodSelect('week')">{{ 'general.dates.week' | translate }}</div>
    <div class="month {{ selectedPeriod === 'month' ? 'checked' : '' }}" (click)="onPeriodSelect('month')">{{ 'general.dates.month' | translate }}</div>
    <div class="year {{ selectedPeriod === 'year' ? 'checked' : '' }}" (click)="onPeriodSelect('year')">{{ 'general.dates.year' | translate }}</div>
  </div>

  <div class="doughnut-chart">
    <canvas baseChart
            class="chart"
            [data]="generateDoughnutChartData(categories)"
            [type]="'doughnut'"
            [options]="{ cutout: '80%', animation: false }"
    >
    </canvas>
  </div>

  <ion-accordion-group>
    <ion-accordion *ngFor="let category of categories; index as i" [value]=i>

      <ion-item slot="header" color="light">
        <ion-row>
          <div>
            <div class="icon-wrapper" [style.background-color]="category.icon.background">
              <ion-icon slot="icon-only" [name]="category.icon.iconType"></ion-icon>
            </div>
            <ion-label>{{ category.name }}</ion-label>
          </div>
          <ion-label>{{ currency$ | async }} {{ category.totalAmount | mrMoneyFormat }}</ion-label>
        </ion-row>
      </ion-item>

      <ion-list slot="content">
        <div
          *ngFor="let item of category.spendingList"
          [class.ion-page-hidden]="item.categoryId !== category.id"
          (click)="spendingService.spendingClickActionsModal(item, categoryList)"
        >
          <ion-label>
            <p *ngIf="item.description" class="spending-description">{{ item.description }}</p>
            <p class="spending-date">{{ item.date | date: 'MMM d, HH:mm' }}</p>
          </ion-label>
          <ion-label class="spending-amount">{{ currency$ | async }} {{ item.amount | mrMoneyFormat }}</ion-label>
        </div>
      </ion-list>

    </ion-accordion>
  </ion-accordion-group>
</ion-content>
